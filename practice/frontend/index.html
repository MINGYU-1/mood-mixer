<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBOE: AI Lyric Analyzer</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://css.gg/css?=|arrow-right" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Nanum+Myeongjo:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- 기본 & 폰트 스타일 --- */
        body { background-color: #0A0A0A; color: #E0E0E0; font-family: 'Noto Sans KR', sans-serif; }
        .font-title { font-family: 'Nanum Myeongjo', serif; }

        /* --- 카드 & 인터랙션 스타일 --- */
        .card { 
            background-color: rgba(26, 26, 26, 0.7); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* 호버 효과를 위한 트랜지션 */
        }
        .card:hover {
            transform: translateY(-8px); /* 위로 살짝 떠오르는 효과 */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
        }

        /* --- 그래디언트 텍스트 스타일 --- */
        .text-gradient-purple {
            background-image: linear-gradient(to right, #a855f7, #d8b4fe);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .text-gradient-teal {
            background-image: linear-gradient(to right, #2dd4bf, #99f6e4);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .text-gradient-amber {
            background-image: linear-gradient(to right, #f59e0b, #fcd34d);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* --- 채팅 버블 스타일 --- */
        .chat-bubble { max-width: 80%; padding: 10px 15px; border-radius: 20px; }
        .user-bubble { background-color: #3B82F6; color: white; align-self: flex-end; border-bottom-right-radius: 5px; }
        .ai-bubble { background-color: #334155; color: #E0E0E0; align-self: flex-start; border-bottom-left-radius: 5px; }
        
        /* --- 로딩 애니메이션 --- */
        .loading-dots span { width: 8px; height: 8px; margin: 0 2px; background-color: #9CA3AF; border-radius: 50%; display: inline-block; animation: bounce 1.4s infinite ease-in-out both; }
        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }

        /* --- 아코디언 메뉴 스타일 --- */
        .lyrics-accordion summary { cursor: pointer; padding: 1rem; background-color: rgba(255, 255, 255, 0.05); border-radius: 0.5rem; transition: background-color 0.2s ease-in-out; display: flex; justify-content: space-between; align-items: center; }
        .lyrics-accordion summary:hover { background-color: rgba(255, 255, 255, 0.1); }
        .lyrics-accordion summary::-webkit-details-marker { display: none; }
        .lyrics-accordion .arrow { transition: transform 0.2s ease-in-out; }
        .lyrics-accordion[open] .arrow { transform: rotate(90deg); }
        .lyrics-accordion .lyrics-content { padding: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.1); }

        /* --- 커스텀 스크롤바 --- */
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.05); border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.4); }

        /* --- 스크롤 애니메이션 --- */
        .fade-in-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-16 md:py-24 max-w-4xl">

        <header class="text-center mb-24 md:mb-32">
            <h1 class="font-title text-4xl md:text-6xl font-bold tracking-widest">OBOE</h1>
            <p class="text-gray-400 mt-4 text-lg md:text-xl">An AI-Powered Analysis of YANG HONG WON's Lyrics</p>
            <p class="text-gray-500 mt-2 text-sm md:text-base">AI의 시선으로 바라본 가사의 의미와 구조</p>
        </header>

        <section class="mb-24 md:mb-32 fade-in-section">
            <div class="text-center max-w-2xl mx-auto">
                <h2 class="font-title text-2xl md:text-3xl font-semibold mb-4">How AI Understands Poetry</h2>
                <p class="text-gray-400 leading-relaxed">
                    양홍원의 가사는 단순한 단어의 나열이 아닌, 복잡한 감정과 은유의 집합체입니다. AI가 이 깊이를 이해하기 위해선, 원본 텍스트를 AI의 언어로 '번역'하는 과정이 필수적입니다. 이 과정은 '전처리'와 '임베딩'이라는 핵심 단계를 거치며, AI가 가사의 숨겨진 맥락을 파악하고 깊이 있는 해석을 생성하는 기반이 됩니다.
                </p>
            </div>
        </section>
        
        <div class="flex justify-center my-16 md:my-24 opacity-50 fade-in-section">
            <img src="https://i.imgur.com/L7sB4P2.jpeg" alt="Oboe album art concept" class="w-64 h-auto mix-blend-lighten"/>
        </div>

        <div class="space-y-12 md:space-y-20">
            <div class="card p-6 md:p-8 rounded-xl fade-in-section">
                <h3 class="font-title text-xl md:text-2xl font-bold text-gradient-purple mb-4">Part 1. 정제 (Preprocessing)</h3>
                <p class="text-gray-400 mb-6">AI가 가사를 학습하기 전, 날것의 텍스트를 의미 있는 단위로 나누고 정제합니다. 불필요한 노이즈를 제거하고, 핵심 의미를 담은 '조각(Chunk)'으로 분할하는 과정은 AI의 이해도를 높이는 첫걸음입니다.</p>
            </div>

            <div class="card p-6 md:p-8 rounded-xl fade-in-section">
                <h3 class="font-title text-xl md:text-2xl font-bold text-gradient-teal mb-4">Part 2. 번역 (Embedding)</h3>
                <p class="text-gray-400 mb-6">정제된 텍스트 조각들은 수많은 차원을 가진 '의미의 공간' 속 벡터(좌표)로 변환됩니다. '이별'과 '상실'은 가까운 곳에, '환희'와 '성취'는 다른 곳에 위치하게 됩니다. 이 과정을 통해 AI는 단어와 문장의 미묘한 의미적 관계를 학습합니다.</p>
            </div>
            
            <div class="card p-6 md:p-8 rounded-xl fade-in-section">
                <h3 class="font-title text-xl md:text-2xl font-bold text-gradient-amber mb-4">Part 3. 해석 (Retrieval & Generation)</h3>
                <p class="text-gray-400 mb-6">"양홍원의 가사에서 '이별'은 어떻게 표현되나?" 라는 질문에, AI는 벡터 공간에서 질문과 가장 가까운 가사 조각들을 검색(Retrieve)합니다. 그리고 이 조각들을 근거로, 질문에 대한 깊이 있는 답변을 새롭게 생성(Generate)합니다.</p>
            </div>
        </div>

        <section class="mt-24 md:mt-32">
            <h2 class="font-title text-center text-3xl md:text-4xl font-bold mb-12 md:mb-16 fade-in-section">Final Analysis: OBOE</h2>
            
            <div class="space-y-12">
                <div class="card p-6 md:p-8 rounded-xl fade-in-section">
                    <h3 class="font-title text-2xl font-bold mb-2">실 (Thread)</h3>
                    <p class="text-gray-500 mb-6 italic">"사실로 엉킨 실로 노를 저어 멀리로"</p>
                    <h4 class="font-semibold text-gradient-purple mb-2">AI-Generated Interpretation:</h4>
                    <p class="text-gray-300 leading-relaxed">'실'은 화자의 복잡한 내면과 관계의 얽힘을 상징합니다. 가사에서 '실'은 '사실'과 발음의 유사성을 통해 진실과 거짓, 현실과 환상이 뒤엉킨 상태를 암시합니다. 화자는 이 엉킨 실, 즉 혼란스러운 현실을 노 삼아 미지의 세계로 나아가려 합니다.</p>
                </div>

                <div class="card p-6 md:p-8 rounded-xl fade-in-section">
                    <h3 class="font-title text-2xl font-bold mb-2">가면무도회 (Masquerade)</h3>
                    <p class="text-gray-500 mb-6 italic">"나 혼자 가면무도회, 그 미소마저 함부로 해"</p>
                    <h4 class="font-semibold text-gradient-teal mb-2">AI-Generated Interpretation:</h4>
                    <p class="text-gray-300 leading-relaxed">'가면무도회'는 도시의 화려함 속에서 느끼는 개인의 소외와 정체성 혼란을 그립니다. 화자는 수많은 군중 속에서 가면을 쓴 채 홀로 춤을 추고 있으며, 심지어 자신의 '미소'마저 진심이 아닌 연기의 일부가 되어버렸습니다.</p>
                </div>
            </div>
        </section>

        <section class="mt-24 md:mt-32 fade-in-section">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="card p-6 rounded-xl">
                    <h3 class="font-title text-2xl font-bold mb-4 text-gradient-purple">전체 가사 보기</h3>
                    <div id="lyrics-container" class="h-96 overflow-y-auto pr-2 space-y-2 custom-scrollbar"></div>
                </div>

                <div class="card p-6 rounded-xl flex flex-col">
                    <h3 class="font-title text-2xl font-bold mb-4 text-gradient-teal">가사 의미 물어보기</h3>
                    <div id="chat-window" class="flex-1 overflow-y-auto mb-4 p-2 flex flex-col space-y-4 custom-scrollbar">
                        <div class="chat-bubble ai-bubble">안녕하세요! 양홍원 '오보에' 앨범에 대해 궁금한 점을 물어보세요.</div>
                    </div>
                    <div id="loading-indicator" class="hidden my-2 pl-2">
                        <div class="chat-bubble ai-bubble loading-dots"><span></span><span></span><span></span></div>
                    </div>
                    <form id="chat-form" class="flex space-x-2">
                        <input type="text" id="chat-input" placeholder="가사에 대해 질문해보세요..." class="flex-1 bg-gray-800 border border-gray-600 rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-teal-400 text-white">
                        <button type="submit" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-5 rounded-full transition-colors">전송</button>
                    </form>
                </div>
            </div>
        </section>

        <footer class="text-center mt-24 md:mt-32 pt-12 border-t border-white/10">
            <p class="text-gray-600">AI-Powered Lyric Analysis Project</p>
            <p class="text-gray-700 text-sm mt-1">Inspired by the works of YANG HONG WON.</p>
        </footer>
    </div>

    <script>
        // --- 데이터 영역 ---
        const lyricsData = `
<실>
흘러가길 피로
흘러가길 1로
이건 내 첫 이별
... (전체 가사는 생략) ...
<사계>
... (전체 가사는 생략) ...
차를 달이길 30에는
        `;
        
        // --- 기능 구현 영역 ---
        document.addEventListener('DOMContentLoaded', () => {
            // 스크롤 애니메이션 설정
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.fade-in-section').forEach(section => {
                observer.observe(section);
            });

            // 가사 아코디언 렌더링
            renderLyricsAccordion();
            
            // 채팅 기능 초기화
            initializeChat();
        });

        function renderLyricsAccordion() {
            const container = document.getElementById('lyrics-container');
            if (!container) return;
            container.innerHTML = '';
            const songs = lyricsData.trim().split(/\n(?=<)/);
            songs.forEach(songText => {
                const match = songText.match(/<(.+?)>\n([\s\S]+)/);
                if (match) {
                    const title = match[1];
                    const lyrics = match[2].trim();
                    const details = document.createElement('details');
                    details.className = 'lyrics-accordion';
                    details.innerHTML = `
                        <summary class="font-title text-lg font-semibold">
                            <span>${title}</span>
                            <i class="gg-arrow-right arrow"></i>
                        </summary>
                        <div class="lyrics-content text-gray-400 whitespace-pre-line">${lyrics}</div>
                    `;
                    container.appendChild(details);
                }
            });
        }

        function initializeChat() {
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            const chatWindow = document.getElementById('chat-window');
            const loadingIndicator = document.getElementById('loading-indicator');

            chatForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const question = chatInput.value.trim();
                if (!question) return;

                appendMessage(question, 'user');
                chatInput.value = '';
                loadingIndicator.style.display = 'block';

                try {
                    const response = await fetch('http://127.0.0.1:5000/ask', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ question })
                    });
                    if (!response.ok) throw new Error('Server error');
                    const data = await response.json();
                    appendMessage(data.answer, 'ai');
                } catch (error) {
                    appendMessage('죄송합니다, 답변 생성에 실패했습니다. 서버 상태를 확인해주세요.', 'ai');
                } finally {
                    loadingIndicator.style.display = 'none';
                }
            });
        }
        
        function appendMessage(text, sender) {
            const chatWindow = document.getElementById('chat-window');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-bubble ${sender === 'user' ? 'user-bubble' : 'ai-bubble'}`;
            messageDiv.innerHTML = text.replace(/\n/g, '<br>');
            chatWindow.appendChild(messageDiv);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

    </script>
</body>
</html>